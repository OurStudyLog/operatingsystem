생성일 | 2024.01.28
작성자 | 이지현
# 14-3 페이지 교체와 프레임 할당

### 요약
- 요구 페이징은 페이지가 필요할 때에만 메모리에 적재하는 기법이다.
- 페이지 교체 알고리즘에는 FIFO, 최적, LRU 페이지 교체 알고리즘 등이 있다.
- 스래싱이란 지나치게 빈번한 페이지 교체로 인해 CPU 이용률이 낮아지는 문제를 의미한다.
- 프레임 할당 방식에는 균당 할당과 비례 할당, 작업 집합 모델 기반과 페이지 폴트율 기반 프레임 할당 방식이 있다.

---
## 요구 페이징

- 프로세스를 메모리에 적재할 때 처음부터 모든 페이지를 적재하지 않고 필요한 페이지만을 메모리에 적재하는 기법.

1. CPU가 특정 페이지에 접근하는 명령어를 실행한다.
2. 해당 페이지가 현재 메모리에 있을 경우(유효 비트 = 1) CPU는 페이지가 적재된 프레임에 접근한다.
3. 해당 페이지가 현재 메모리에 없을 경우(유효 비트 = 0) 페이지 폴트가 발생.
4. 페이지 폴트 처리 루틴은 해당 페이지를 메모리로 적재하고 유효 비트를 1로 설정
5. 다시 1번만 수행.

- 순수 요구 페이징: 첫 명령어를 실행하는 순간부터 페이지 폴트가 계속 발생하게 되고, 실행에 필요한 페이지가 어느 정도 적재된 이후부터는 페이지 폴트 발생 빈도가 떨어진다.

안정적인 작동을 위한 필연적인 해결 조건
- 페이지 교체: 메모리에서 내보낼 페이지를 결정하는 페이지 교체 알고리즘.
- 프레임 할당: 프로세스가 필요로 하는 최소한의 프레임 수를 보장하기 위해 프레임 할당을 한다.

---

> 페이지 교체 알고리즘을 왜 사용하는지, 무엇이 좋은 페이지 교체 알고리즘인지, 대표적인 페이지 교체 알고리즘들의 기본적인 아이디어는 무엇인지를 이해하는 데에 중점을 두길 권한다.

## 페이지 교체 알고리즘

- 페이지 참조열을 통해 페이지 폴트 횟수를 알 수 있어야 한다.
	- 페이지 폴트의 발생 횟수만을 평가하기 때문에 어차피 페이지 폴트가 일어나지 않을 연속된 페이지에 대한 참조는 고려하지 않는다.
### FIFO 페이지 교체 알고리즘

- 오래 머물렀다면 나가라.
- 아이디어와 구현이 간단하지만, 프로그램 실행 내내 사용될 내용이 포함된 페이지의 경우 문제가 있다.
- 2차 기회  페이지 교체 알고리즘: 참조 비트를 한 번 0으로 만들어 접근하지 않았던 것으로 처리. 메모리에 가장 오래 머무른 페이지의 참조 비트가 0이라면 내쫓기.

### 최적 페이지 교체 알고리즘

- 사용 빈도가 가장 낮을 페이지를 교체하는 알고리즘.
- 가장 낮은 페이지 폴트율을 보장한다.
- 실제 구현이 어렵다. 예측이 어렵기 때문이다.
- 성능평가용 목적: 해당 알고리즘을 실행했을 때 발생하는 페이지 폴트 횟수를 페이지 폴트의 하한선으로 간주하고, 이를 기준으로 페이지 폴트 횟수가 얼마나 발생하느냐를 통해 페이지 교체 알고리즘을 평가하기 위해 사용한다.

### LRU 페이지 교체 알고리즘

- 가장 오랫동안 사용하지 않은 페이지를 교체하는 알고리즘.
- 최근에 사용되지 않은 페이지는 앞으로도 사용되지 않을 것이라는 가정으로 구현.

----

## 스래싱과 프레임 할당

- 프로세스가 사용할 수 있는 프레임 수가 적어도 페이지 폴트는 자주 발생한다.
- 스래싱: 프로세스가 실제 실행되는 시간보다 페이징에 더 많은 시간을 소요하여 성능이 저해되는 문제
	- 가로축: 멀티프로그래밍의 정도: 메모리에 올라와 있는 프로세스의 수
	- 세로축: CPU 이용률

- 스래싱이 발생하는 이유
	- 각 프로세스가 필요로 하는 최소한의 프레임 수가 보장되지 않았기 때문이다.
	- 따라서 각 프로세스들이 무리 없이 실행하기 위한 최소한의 프레임 수를 파악하고 프로세스들에 적절할 수만큼 프레임을 할당해 줄 수 있어야 한다. -> 프레임 할당

### 프레임 할당 방식

- 정적 할당: 프로세스의 실행 과정을 고려하지 않고 프로세스의 크기와 물리 메모리의 크기만을 고려한 방식 - 균등 할당과 비례 할당
	- 균등 할당: 모든 프로세스에 균등하게 프레임을 제공하는 방식
	- 비례 할당; 프로세스의 크기에 따라 비례하여 프레임을 나눠주는 방식

-  동적 할당: 프로세스를 실행하는 과정에서 배분할 프레임을 결정하는 방식
	- 작업 집합 모델: 프로세스가 일정 기간 동안 참조한 페이지 집합을 기억하여 빈번한 페이지 교체를 방지한다. - 참조 지역성의 원리
		- 작업 집합: 실행 중인 프로세스가 일정 시간 동안 참조한 페이지의 집합.
		- CPU가 과거에 주로 참조한 페이지를 작업 집합에 포함한다면 운영체제는 작업 집합의 크기만큼만 프레임을 할당해 주면 된다.
	- 페이지 폴트 빈도: 페이지 폴트율에 상한선과 하한선을 정하고 범위 안에서만 프레임을 할당하는 방식
		- 페이지 폴트율이 상한선보다 더 높아지면 너무 적은 프레임을 갖고 있다고 판단하여 프레임을 추가 할당한다.
		- 하하선보다 낮아지면 프레임을 회수한다.

----
### 퀴즈

디스커션 링크: